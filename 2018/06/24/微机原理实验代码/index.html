<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="显示一段以$结尾字符串;利用9号功能调用显示 DATA    SEGMENT MESS    DB &amp;quot;HELLO$&amp;quot; DATA    ENDS  CODE    SEGMENT ASSUME    CS:CODE,DS:DATA  START: MOV AX,DATA MOV    DX,AX LEA    DX,MESS MOV    AH,9 INT    21H MOV">
<meta property="og:type" content="article">
<meta property="og:title" content="微机实验代码">
<meta property="og:url" content="http://yoursite.com/2018/06/24/微机原理实验代码/index.html">
<meta property="og:site_name" content="Jason&#39;s sky">
<meta property="og:description" content="显示一段以$结尾字符串;利用9号功能调用显示 DATA    SEGMENT MESS    DB &amp;quot;HELLO$&amp;quot; DATA    ENDS  CODE    SEGMENT ASSUME    CS:CODE,DS:DATA  START: MOV AX,DATA MOV    DX,AX LEA    DX,MESS MOV    AH,9 INT    21H MOV">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-07-08T15:02:59.027Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="微机实验代码">
<meta name="twitter:description" content="显示一段以$结尾字符串;利用9号功能调用显示 DATA    SEGMENT MESS    DB &amp;quot;HELLO$&amp;quot; DATA    ENDS  CODE    SEGMENT ASSUME    CS:CODE,DS:DATA  START: MOV AX,DATA MOV    DX,AX LEA    DX,MESS MOV    AH,9 INT    21H MOV">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/06/24/微机原理实验代码/"/>





  <title>微机实验代码 | Jason's sky</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jason's sky</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">everbodyup</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/24/微机原理实验代码/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王嘉熙">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason's sky">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">微机实验代码</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-24T11:25:00+08:00">
                2018-06-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2018/06/24/微机原理实验代码/" class="leancloud_visitors" data-flag-title="微机实验代码">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,354
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="显示一段以-结尾字符串"><a href="#显示一段以-结尾字符串" class="headerlink" title="显示一段以$结尾字符串"></a>显示一段以$结尾字符串</h1><pre><code>;利用9号功能调用显示
DATA    SEGMENT
MESS    DB &quot;HELLO$&quot;
DATA    ENDS

CODE    SEGMENT
ASSUME    CS:CODE,DS:DATA

START:
MOV AX,DATA
MOV    DX,AX
LEA    DX,MESS
MOV    AH,9
INT    21H
MOV    AH,4CH
INT    21H
CODE ENDS
END    START
</code></pre><h1 id="实现加法运算"><a href="#实现加法运算" class="headerlink" title="实现加法运算"></a>实现加法运算</h1><pre><code>;转换BCD输出，十进制字符加32
CODE    SEGMENT
START:
MOV AH,00H
MOV    AL,11H
MOV    BL,1BH
ADD    AL,BL
MOV CH,0AH
CBW
IDIV
MOV BL,AH
OR    AL,30H
MOV    DX,AL
MOV    AH,02H
INT    21H
MOV    AH,BL
MOV DX,AH
MOV    AH,02H
INT    21H
MOV    AH,4CH
INT    21H
CODE ENDS
END    START
</code></pre><h1 id="8255软延时跑马灯"><a href="#8255软延时跑马灯" class="headerlink" title="8255软延时跑马灯"></a>8255软延时跑马灯</h1><pre><code>CODE SEGMENT
ASSUME CS:CODE
MOV    AL,89H    ;控制字，A口方式0输出，B口方式0输出，C口输入
MOV    DX,283H    ;指向控制口寄存器
OUT    DX,AL
MOV    AL,01    ;置高位
MOV    DX,281H    ;指向B口寄存器
AGAIN:
OUT    DX,AL    ;B口控制LED灯亮
ROL    AL,1    ;LED亮灯循环左移
MOV    BX,30    
DELAY:MOV        CX,16EAH
DELAY1:LOOP    DELAY    ;延时20ms
DEC    BX            
JNZ    DELAY    ;调用第二重延时
JMP    AGAIN    ;循环
CODE ENDS
END                   
</code></pre><h1 id="基于8253硬延时跑马灯"><a href="#基于8253硬延时跑马灯" class="headerlink" title="基于8253硬延时跑马灯"></a>基于8253硬延时跑马灯</h1><pre><code>CODE SEGMENT
ASSUME CS:CODE
START:
MOV    DX,28BH        ;指向控制口寄存器
MOV    AL,00110101B    
;通道0，先写低字节，后写高字节，方式2，BCD计数
OUT    DX,AL    ;写入控制字
MOV    DX,288H    ;指向A口寄存器
MOV    AL,00H    ;计数初值低字节
OUT    DX,AL    
MOV    AL,50H    ;计数初值高字节
OUT    DX,AL    

MOV    DX,28BH    ;指向控制口寄存器
MOV    AL,01110111B    
;通道1，先写低字节，后高字节，方式3，BCD计数
OUT    DX,AL    ;
MOV    DX,289H    ;指向B口
MOV    AL,00H    ;计数初值低字节
OUT    DX,AL    
MOV    AL,10H    ;计数初值高字节
OUT    DX,AL    
MOV    DX,283H        
MOV    AL,10011001B     ;A口方式0输入，B口方式0输出，C口输入
OUT    DX,AL
MOV    BL,01H    ;置高位


DELAY1:
MOV    DX,282H    ;指向C口
IN     AL,DX    ;输入
TEST    AL,01H
JNZ    DELAY1    ;低电平跳出                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             

RUN1:
MOV    DX,281H    ;指向B口
MOV    AL,BL    
OUT    DX,AL    ;输出

DELAY2:
MOV    DX,282H    ;指向C口
IN    AL,DX    ;输入
TEST    AL,01H                                                                               
JZ    DELAY2    ;高电平跳出
ROL BL,1        ;循环左移
JMP DELAY1        ;延时
CODE ENDS
END START
</code></pre><h1 id="四成四回显键盘"><a href="#四成四回显键盘" class="headerlink" title="四成四回显键盘"></a>四成四回显键盘</h1><p>1.检查键是否都松开<br>2.检查是否有键压下<br>3.有键压下消除抖动<br>4.编码压下的键，转换成16进制码确定哪个键被压下<br>5.释放键重复2步骤</p>
<pre><code>;端口地址
PA    EQU        280H    ;8255A口地址
PB    EQU        281H
PCTL  EQU         283H
;数据段键盘扫码表
DATA    SEGMENT
;            0    1    2    3    4      5       6    7
TABLE    DB 77H, 7BH, 7DH, 7EH, 0B7H, 0BBH, 0BDH,0BEH
;             8    9      A       B       C         D      E      F
    DB 0D7H,0DBH,0DDH, 0DEH, 0E7H, 0EBH, 0EDH, 0EEH
TABLE1   DB 3FH,06H,5BH,4FH,66H,6DH,7DH,07H,
  DB 7FH,6FH,77H,7CH,39H,5EH,79H,71H   ;LED段码表，共阳极
DATA    ENDS
;堆栈段
STACK    SEGMENT        STACK
    DW    50    DUP(0)
TOP        LABEL    WORD
STACK    ENDS
;代码段
CODE    SEGMENT
    ASSUME    CS:CODE,DS:DATA,SS:STACK
START:    MOV AX,STACK
        MOV SS,AX
        LEA SP,TOP
        MOV AX,DATA
        MOV DS,AX
    ;初始化8255A，方式0，A口输出，B口输入，C口输出
        MOV DX,PCTL    ;控制口
        MOV AL,10000010B    ;控制字
        OUT DX,AL
    ;向所有行送0
SEND:     MOV DX,PA        ;A口
        MOV AL,00H
        OUT DX,AL    ;向A口各位输出0
    ;读列，查看是否所有键松开
        MOV DX,PB
WAIT_OPEN: IN  AL,DX    ;读入B口
        AND AL,0FH        ;查低4位
        CMP AL,0FH        ;是否都为1
        JNE WAIT_OPEN    ;否，继续查
    ;查各列是否有0，即有键按下
WAIT_PRES: MOV DX,PB
        IN  AL,DX        ;读B口
        AND AL,0FH        ;查低4位
        CMP AL,0FH        ;是否有键压下
        JE  WAIT_PRES        ;无，等待
    ;消抖20ms
        MOV CX,16EAH    
DELAY:  LOOP DELAY    ;延时20ms
    ;查列，看键是否仍然被压下
        IN  AL,DX        
        AND AL,0FH
        CMP AL,0FH
        JE  WAIT_PRES        ;松开，转出等待压键
    ;确定哪一个键被按下
        MOV AL,0FEH    ;D0=0
        MOV CL,AL    ;CL=1111 1110B
NEXT_ROW: MOV DX,PA    ;A口
        OUT DX,AL    ;一行输出低电平
        MOV DX,PB    ;B口
        IN  AL,DX    ;读入
        AND AL,0FH        ;截取列值
        CMP AL,0FH        ;是否为1
        JNE ENCODE    ;否，有键压下，转去编码
        ROL CL,01    ;循环，下行输出0
        MOV AL,CL
        JMP NEXT_ROW    ;查看下行

ENCODE: MOV BX,000FH    ;建立地址指针，先指向F键对应的地址
            IN  AL,DX    ;从B口读入行列状态
NEXT_TRY:    CMP AL,TABLE[BX]    ;读入行列值与表中值是否相等
        JE  DONE    ;相等，转出
        DEC BX    ;不等，指向下一个键值
        JNS NEXT_TRY    ;地址不为负继续查
        MOV AH,01    ;地址为负，置错码01-&gt;AH
        JMP EXIT        ;退出
DONE:MOV AL,TABLE1[BX]    ; 数码管偏移地址
        MOV DX,282H    ;C口
        OUT DX,AL    ;输出到数码管
        JMP SEND    ;跳转A口送0阶段
EXIT:    HLT
MOV AL,4CH
INT 21H
CODE    ENDS
END START
</code></pre><h1 id="利用0832产生锯齿波输出，并驱动直流电机工作。"><a href="#利用0832产生锯齿波输出，并驱动直流电机工作。" class="headerlink" title="利用0832产生锯齿波输出，并驱动直流电机工作。"></a>利用0832产生锯齿波输出，并驱动直流电机工作。</h1><pre><code>CODE SEGMENT
ASSUME CS:CODE
MOV DX,280H    ;输入寄存器
START:    MOV AL,0FFH    ;初值为0FFH
AGAIN:    INC AL    ;AL增1
OUT DX,AL    ;D/A转换
MOV BX,80H        ;初值为80H
DELAY :     MOV CX,16EAH        
DELAY1: LOOP DELAY        ;延时20ms
DEC BX    
JNZ DELAY    ;双重延时
JMP AGAIN    ;继续转换输出
</code></pre><h1 id="利用0809完成1个通道的模拟量采集，并利用8255输出二进制码"><a href="#利用0809完成1个通道的模拟量采集，并利用8255输出二进制码" class="headerlink" title="利用0809完成1个通道的模拟量采集，并利用8255输出二进制码"></a>利用0809完成1个通道的模拟量采集，并利用8255输出二进制码</h1><pre><code>CODE SEGMENT
ASSUME CS:CODE
START:    
    MOV DX,283H    ;控制口寄存器
    MOV AL,10010000B        ;A口方式0输入B口方式0输出C口输出
    OUT DX,AL    
NEXT:
    MOV DX,288H    ;选中IN0通道
    OUT DX,AL    ;启动转换
    MOV DX,280H    ;A口寄存器
POLL:
    IN AL,DX        ;读入
    TEST AL,01H        ;测EOC是否为高
    JZ POLL        ;EOC=1转换结束跳出
    MOV DX,288H    ;IN0通道
    IN AL,DX        ;读入
    MOV DX,281H    ;B口寄存器
    OUT DX,AL    ;输出
    JMP NEXT    ;继续转换
CODE ENDS
END START
</code></pre>
      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="王嘉熙 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="王嘉熙 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/06/18/后期PS/" rel="next" title="摄影后期干货">
                <i class="fa fa-chevron-left"></i> 摄影后期干货
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/07/08/ctf -bugku/" rel="prev" title="sql注入">
                sql注入 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="王嘉熙" />
            
              <p class="site-author-name" itemprop="name">王嘉熙</p>
              <p class="site-description motion-element" itemprop="description">Nothing is impossible</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">39</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/08163182" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:wjx15896427883@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/Jason_wang9527" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://instagram.com/jason_wang9527" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#显示一段以-结尾字符串"><span class="nav-number">1.</span> <span class="nav-text">显示一段以$结尾字符串</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#实现加法运算"><span class="nav-number">2.</span> <span class="nav-text">实现加法运算</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8255软延时跑马灯"><span class="nav-number">3.</span> <span class="nav-text">8255软延时跑马灯</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#基于8253硬延时跑马灯"><span class="nav-number">4.</span> <span class="nav-text">基于8253硬延时跑马灯</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四成四回显键盘"><span class="nav-number">5.</span> <span class="nav-text">四成四回显键盘</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#利用0832产生锯齿波输出，并驱动直流电机工作。"><span class="nav-number">6.</span> <span class="nav-text">利用0832产生锯齿波输出，并驱动直流电机工作。</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#利用0809完成1个通道的模拟量采集，并利用8255输出二进制码"><span class="nav-number">7.</span> <span class="nav-text">利用0809完成1个通道的模拟量采集，并利用8255输出二进制码</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">王嘉熙</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4
<span>   |   </span>
<span id="showDays"></span>
</div>




<script>
  var seconds = 1000;
  var minutes = seconds * 60;
  var hours = minutes * 60;
  var days = hours * 24;
  var years = days * 365;
  var birthDay = Date.UTC(2018,02,10,00,00,00); // 这里设置建站时间
  setInterval(function() {
    var today = new Date();
    var todayYear = today.getFullYear();
    var todayMonth = today.getMonth()+1;
    var todayDate = today.getDate();
    var todayHour = today.getHours();
    var todayMinute = today.getMinutes();
    var todaySecond = today.getSeconds();
    var now = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
    var diff = now - birthDay;
    var diffYears = Math.floor(diff/years);
    var diffDays = Math.floor((diff/days)-diffYears*365);
    var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
    var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
    var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
      document.getElementById('showDays').innerHTML="博客已运行 "+diffYears+" 年 "+diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
  }, 1000);
</script>
        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("s8OK1yas4CmWRhxmuW1FJq2Q-gzGzoHsz", "uY78z9PJL2vdt76Nv08OYE3R");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  


<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>

</body>

<!-- 页面点击小心心 -->
<script type="text/javascript" src="/js/src/love.js"></script>

<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.12.0/styles/atom-one-dark.min.css">

<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script type="text/javascript">
  $(function() {
    hljs.initHighlighting();
    $('pre code').each(function() {
      var lines = $(this).text().split('\n').length - 1;
      var $numbering = $('<ul/>').addClass('pre-numbering');
      $(this)
        .addClass('has-numbering')
        .parent()
        .append($numbering);
      for (i = 1; i <= lines; i++) {
        $numbering.append($('<li/>'));
      }
    });
  });

</script>

<style>
  pre {
    position: relative;
    padding: 0;
  }

  code.has-numbering {
    margin-left: 2.5rem;
  }

  code.has-numbering::-webkit-scrollbar {
    display: none;
  }

  .pre-numbering {
    margin: 0;
    position: absolute;
    top: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    height: 100%;
  }

  .pre-numbering li {
    list-style-type: decimal-leading-zero !important;
  }

  @media (max-width: 760px) {
    .post-body pre {
      padding: 0px;
    }

    .post-body .pre-numbering {
      display: none;
    }

    code.has-numbering {
      margin: 0;
    }
  }

</style>

</html>
